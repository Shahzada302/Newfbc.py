import requests
import re

print("[🔍] Collecting trusted user-agents (US/UK origin)...")

headers = {
    "User-Agent": "Mozilla/5.0"
}

response = requests.get("https://developers.whatismybrowser.com/useragents/explore/software_name/facebook-app/", headers=headers)

if response.status_code != 200:
    print("[❌] Failed to fetch user-agents!")
    exit()

raw_data = response.text
agents = re.findall(r'<a href="\/useragents\/parse\/\d+">([^<]+)<\/a>', raw_data)

trusted_agents = []

for agent in agents:
    if "Mobile" in agent and ("Android" in agent or "iPhone" in agent) and ("United States" in agent or "United Kingdom" in agent or "en-US" in agent or "en-GB" in agent):
        trusted_agents.append(agent)

if not trusted_agents:
    print("[❌] No trusted US/UK user-agents found.")
else:
    with open("trusted_user_agents.txt", "w") as file:
        for ua in trusted_agents:
            file.write(ua.strip() + "\n")
    print(f"[✅] {len(trusted_agents)} trusted user-agents saved in 'trusted_user_agents.txt'")
